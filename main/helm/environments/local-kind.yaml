# =============================================================================
# Local Kind Cluster Environment
# =============================================================================
# For team members running on local Kind cluster (localhost)
# Namespace: wealist-kind-local

# -----------------------------------------------------------------------------
# Global Settings
# -----------------------------------------------------------------------------
global:
  namespace: wealist-kind-local
  environment: local
  domain: localhost
  imageRegistry: localhost:5001

# -----------------------------------------------------------------------------
# cert-manager Configuration (Disabled for localhost)
# -----------------------------------------------------------------------------
certManager:
  enabled: false

# -----------------------------------------------------------------------------
# Deployment Settings
# -----------------------------------------------------------------------------
replicaCount: 1

image:
  pullPolicy: Always  # Always pull for development
  tag: "latest"       # Local images use :latest tag

# -----------------------------------------------------------------------------
# Resources - Use service-specific defaults
# -----------------------------------------------------------------------------
# Note: Removed global resource override. Each service uses its own values:
# - Go services: 128Mi-256Mi (fast, low memory)
# - auth-service (Spring Boot): 512Mi-1Gi (JVM needs more memory)
# Overriding globally caused OOMKilled for Spring Boot services.

# -----------------------------------------------------------------------------
# Health Check - Use service-specific defaults
# -----------------------------------------------------------------------------
# Note: Removed global healthCheck override. Each service uses its own values:
# - Go services: 30s liveness, 10s readiness (fast startup)
# - auth-service (Spring Boot): 60s liveness, 45s readiness (slow startup)

# -----------------------------------------------------------------------------
# Security (Relaxed for local development)
# -----------------------------------------------------------------------------
podSecurityContext:
  runAsNonRoot: false

securityContext:
  allowPrivilegeEscalation: false
  runAsNonRoot: false
  runAsUser: 0  # Required for nginx (frontend) to run chown
  readOnlyRootFilesystem: false
  capabilities:
    drop: []  # Override base.yaml's drop ALL - local dev doesn't need strict caps

# -----------------------------------------------------------------------------
# Features Disabled for Local 로컬 환경에서의 설정
# -----------------------------------------------------------------------------
autoscaling:
  enabled: false

serviceAccount:
  create: false

networkPolicy:
  enabled: false

podDisruptionBudget:
  enabled: false

# -----------------------------------------------------------------------------
# Service-Specific Scaling Configuration (새로 추가)
# -----------------------------------------------------------------------------
auth-service:
  replicaCount: 2    # 인증 서비스 - 고가용성 필요

board-service:
  replicaCount: 2    # 게시판 - 트래픽 많음

chat-service:
  replicaCount: 3    # 채팅 - 실시간, 높은 처리량

user-service:
  replicaCount: 2    # 사용자 관리

storage-service:
  replicaCount: 2    # 파일 업로드/다운로드

video-service:
  replicaCount: 1    # 비디오 처리 - 리소스 집약적

noti-service:
  replicaCount: 1    # 알림 서비스

frontend:
  replicaCount: 1    # 프론트엔드

# -----------------------------------------------------------------------------
# Shared Configuration
# -----------------------------------------------------------------------------
shared:
  config:
    ENV: "local"
    LOG_LEVEL: "debug"
    CORS_ORIGINS: "*"
    S3_PUBLIC_ENDPOINT: "http://localhost/minio"
    LIVEKIT_WS_URL: "ws://localhost/svc/livekit"
    # OAuth2 Redirect URLs (localhost, no TLS)
    OAUTH2_CLIENT_REDIRECT_URI: "http://localhost/login/oauth2/code/google"
    OAUTH2_REDIRECT_URL_ENV: "http://localhost/oauth/callback"
    # Auto-migrate DB schema (local dev only)
    DB_AUTO_MIGRATE: "true"

# -----------------------------------------------------------------------------
# Ingress (localhost, no TLS)
# -----------------------------------------------------------------------------
ingress:
  enabled: true
  annotations:
    nginx.ingress.kubernetes.io/ssl-redirect: "false"
  hosts:
    - host: localhost
  tls: []
